(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{13:function(t,e,n){t.exports=n(26)},19:function(t,e,n){},22:function(t,e,n){},26:function(t,e,n){"use strict";n.r(e);var r=n(0),a=n.n(r),o=n(4),i=n.n(o),c=(n(19),n(1)),s=n.n(c),u=n(2),l=n(5),d=n(6),f=n(11),h=n(7),p=n(12),m=n(8),v=n.n(m),g=(n(22),n(9)),y=n(10),w=n.n(y),b=function(t){return w()(t.slice(0,10),"YYYY-MM-DD")},Y=function(t){var e=b(t.from);return t.data.reduce(function(t,n){return n&&(t[e.format("YYYY-MM-DD")]=Number(n)),e.add(1,"days"),t},{})},k=function(t){var e=t.history.total,n=b(e.from);return e.data.reduce(function(t,e){return e&&(t[n.format("YYYY-MM-DD")]=Number(e)),n.add(1,"days"),t},{})},D=function(t,e){return t.reduce(function(t,n){var r=n.type;if(["sell","buy","transfer"].includes(r))return t;var a=b(n.date),o=t[a.format("YYYY-MM-DD")]?t[a.format("YYYY-MM-DD")]:{deposit:0,withdrawal:0,interest:0,income:0},i=Number(n.currency_amount);return i=n.investment&&n.investment.includes(":usd")?function(t,e,n){return e/n.get(t.format("YYYY-MM-DD"))}(a,i,e):i,"deposit"==r&&o?o.deposit+=i:["fee","interest","tax"].includes(r)?o.interest+=i:["income","dividend","distribution"].includes(r)?o.income+=i:"withdrawal"==r?o.withdrawal+=i:console.error("Unknown type",r),t},{})},F=function(t){function e(t){var n;return Object(l.a)(this,e),(n=Object(f.a)(this,Object(h.a)(e).call(this,t))).getAddon=function(){try{var t=new g.Addon({});return t.on("init",function(t){console.log("Addon initialization",t),n.loadData(t)}),t.on("reload",function(){}),t.on("update",function(t){console.log("Addon update - options: ",t),n.loadData(t)}),t}catch(e){console.log(e)}return null},n.state={addon:n.getAddon(),currencyCache:{},combinedPortfolioData:{},portfolio:{},isLoaded:!1},n}return Object(p.a)(e,t),Object(d.a)(e,[{key:"loadCurrenciesCache",value:function(){var t=Object(u.a)(s.a.mark(function t(){var e=this;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.state.currencyCache){t.next=3;break}return console.log("Skip re-loading currency cache."),t.abrupt("return");case 3:return console.log("Loading currencies data."),t.next=6,this.state.addon.request({method:"GET",endpoint:"currencies/usd/history",query:{base:"cad"}}).then(function(t){var n=Y(t);console.log("Currency cache: ",n),e.setState({currencyCache:n})}).catch(function(t){console.error("Failed to load currency data.",t)});case 6:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"loadData",value:function(){var t=Object(u.a)(s.a.mark(function t(e){var n,r;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.loadCurrenciesCache();case 2:return t.next=4,this.loadPortfolioData(e);case 4:return n=t.sent,t.next=7,this.loadTransactions(e);case 7:r=t.sent,Object.keys(r).forEach(function(t){r[t].value=n[t]}),this.setState({portfolio:n,combinedPortfolioData:r});case 10:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"loadPortfolioData",value:function(){var t=Object(u.a)(s.a.mark(function t(e){var n;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("Loading portfolio data."),n={from:e.dateRangeFilter&&e.dateRangeFilter[0],to:e.dateRangeFilter&&e.dateRangeFilter[1],groups:e.groupsFilter,institutions:e.institutionsFilter,investments:"all"===e.investmentsFilter?null:e.investmentsFilter},t.next=4,this.state.addon.request({query:n,method:"GET",endpoint:"portfolio"}).then(function(t){var e=k(t);return console.log("Portfolio data: ",e),e}).catch(function(t){console.error("Failed to load portfolio data.",t)});case 4:return t.abrupt("return",{});case 5:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"loadTransactions",value:function(){var t=Object(u.a)(s.a.mark(function t(e){var n,r=this;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("Loading transactions data."),n={groups:e.groupsFilter,institutions:e.institutionsFilter,investments:"all"===e.investmentsFilter?null:e.investmentsFilter},t.next=4,this.state.addon.request({query:n,method:"GET",endpoint:"transactions"}).then(function(t){var e=D(t,r.state.currencyCache);return console.log("Transactions data: ",e),e}).catch(function(t){console.error("Failed to load transactions data.",t)});case 4:return t.abrupt("return",{});case 5:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"render",value:function(){return a.a.createElement("div",{className:"App"},a.a.createElement("header",{className:"App-header"},a.a.createElement("img",{src:v.a,className:"App-logo",alt:"logo"}),a.a.createElement("p",null,"Wealthica React Portfolio add using highcharts."),a.a.createElement("a",{className:"App-link",href:"https://reactjs.org",target:"_blank",rel:"noopener noreferrer"},"Learn React")))}}]),e}(r.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(a.a.createElement(F,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()})},8:function(t,e,n){t.exports=n.p+"static/media/logo.5d5d9eef.svg"}},[[13,1,2]]]);
//# sourceMappingURL=main.2a38e23e.chunk.js.map